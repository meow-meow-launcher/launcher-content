import{b as ie}from"./BkJeMoP0.js";import{g as U}from"./CvtTglqh.js";import{t as Z}from"./O0opt6N1.js";import j from"./DuUTf5mV.js";import{r as J,m as ae,q as se,l as B,f as M,o as I,w as R,b as V,i as c,s as H,P as G,j as F,n as re,B as N,v as oe,x as ue,c as D,F as ee,y as de,z as A,a as ce,A as W,d as fe,t as pe}from"./BH4CL5cc.js";import{u as ge}from"./DZhIbw6z.js";import{u as le,l as ve}from"./BWoT6vWr.js";import{M as me}from"./D_vDscbT.js";import{c as ye}from"./qgkefjPh.js";import{u as he}from"./BYGrLFL5.js";import{u as ke}from"./CmBXxmme.js";import{f as Y}from"./D6t4sbvV.js";import{_ as be}from"./Cye3TvHh.js";import{P as ne}from"./DGROana5.js";import{g as Q}from"./FUKBWQwh.js";import{u as xe}from"./CRXAASKd.js";import{_ as Ie}from"./C0SU7Eqr.js";import{h as te}from"./ChOKVcqp.js";import{r as Te}from"./4qzInpf6.js";import"./wSbNHcIL.js";import"./BFXmnonR.js";import"./zkBJax86.js";import"./C4IQEttf.js";import"./kkUWTacr.js";import"./B8fnFyT8.js";function X(r){return r.reduce((v,e)=>(v.push(e),e.children&&v.push(...X(e.children)),v),[])}function Ce(r,v){const e=J(),f=(n,T)=>{if(v.multiple&&Array.isArray(r.value))if(v.selectionBehavior==="replace")r.value=[n],e.value=n;else{const b=r.value.findIndex(o=>T(o));b!==-1?r.value.splice(b,1):r.value.push(n)}else v.selectionBehavior==="replace"?r.value={...n}:!Array.isArray(r.value)&&T(r.value)?r.value=void 0:r.value={...n};return r.value};function w(n,T,b,o){var x;if(!(e!=null&&e.value)||!v.multiple||!Array.isArray(r.value))return;const C=(x=b().filter(K=>K.ref.dataset.disabled!=="").find(K=>K.ref===T))==null?void 0:x.value;if(!C)return;let m=null;switch(n){case"prev":case"next":{m=Y(o,e.value,C);break}case"first":{m=Y(o,e.value,o==null?void 0:o[0]);break}case"last":{m=Y(o,e.value,o==null?void 0:o[o.length-1]);break}}r.value=m}return{firstValue:e,onSelectItem:f,handleMultipleReplace:w}}const[Ke,Se]=ye("TreeRoot"),Ee=ae({__name:"TreeRoot",props:{modelValue:{},defaultValue:{},items:{},expanded:{},defaultExpanded:{},getKey:{},getChildren:{type:Function,default:r=>r.children},selectionBehavior:{default:"toggle"},multiple:{type:Boolean},dir:{},disabled:{type:Boolean},propagateSelect:{type:Boolean},asChild:{type:Boolean},as:{default:"ul"}},emits:["update:modelValue","update:expanded"],setup(r,{emit:v}){const e=r,f=v,{items:w,multiple:n,disabled:T,propagateSelect:b,dir:o}=se(e),{handleTypeaheadSearch:u}=he(),C=ke(o),m=J(),x=J(!1),K=ve(),i=le(e,"modelValue",f,{defaultValue:e.defaultValue??(n.value?[]:void 0),passive:e.modelValue===void 0,deep:!0}),p=le(e,"expanded",f,{defaultValue:e.defaultExpanded??[],passive:e.expanded===void 0,deep:!0}),{onSelectItem:S,handleMultipleReplace:t}=Ce(i,e),s=B(()=>n.value&&Array.isArray(i.value)?i.value.map(a=>e.getKey(a)):[e.getKey(i.value??{})]);function l(a,d=1,g){return a.reduce((h,k,q)=>{const z=e.getKey(k),P=e.getChildren(k),$=p.value.includes(z),L={_id:z,value:k,index:q,level:d,parentItem:g,hasChildren:!!P,bind:{value:k,level:d,"aria-setsize":a.length,"aria-posinset":q+1}};return h.push(L),P&&$&&h.push(...l(P,d+1,k)),h},[])}const y=B(()=>{const a=e.items;return p.value.map(d=>d),l(a??[])});function _(a){var d;if(x.value)K.trigger(a);else{const g=((d=m.value)==null?void 0:d.getItems())??[];u(a.key,g)}}function E(a){if(x.value)return;const d=me[a.key];re(()=>{var g;t(d,Q(),(g=m.value)==null?void 0:g.getItems,y.value.map(h=>h.value))})}return Se({modelValue:i,selectedKeys:s,onSelect:a=>{var h;const d=k=>e.getKey(k??{})===e.getKey(a),g=e.multiple&&Array.isArray(i.value)?((h=i.value)==null?void 0:h.findIndex(d))!==-1:void 0;if(S(a,d),e.propagateSelect&&e.multiple&&Array.isArray(i.value)){const k=X(e.getChildren(a)??[]);g?i.value=[...i.value].filter(q=>!k.some(z=>e.getKey(q??{})===e.getKey(z))):i.value=[...i.value,...k]}},expanded:p,onToggle(a){if(!(a?e.getChildren(a):void 0))return;const g=e.getKey(a)??a;p.value.includes(g)?p.value=p.value.filter(h=>h!==g):p.value.push(g)},getKey:e.getKey,getChildren:e.getChildren,items:w,expandedItems:y,disabled:T,multiple:n,dir:C,propagateSelect:b,isVirtual:x,virtualKeydownHook:K,handleMultipleReplace:t}),(a,d)=>(I(),M(c(be),{ref_key:"rovingFocusGroupRef",ref:m,"as-child":"",orientation:"vertical",dir:c(C)},{default:R(()=>[V(c(ne),{role:"tree",as:a.as,"as-child":a.asChild,"aria-multiselectable":c(n)?!0:void 0,onKeydown:[_,H(G(E,["shift"]),["up","down"])]},{default:R(()=>[F(a.$slots,"default",{flattenItems:y.value,modelValue:c(i),expanded:c(p)})]),_:3},8,["as","as-child","aria-multiselectable","onKeydown"])]),_:3},8,["dir"]))}}),we="tree.select",Ae="tree.toggle",Be=ae({inheritAttrs:!1,__name:"TreeItem",props:{value:{},level:{},asChild:{type:Boolean},as:{default:"li"}},emits:["select","toggle"],setup(r,{expose:v,emit:e}){const f=r,w=e,n=Ke(),{getItems:T}=xe(),b=B(()=>!!n.getChildren(f.value)),o=B(()=>{const t=n.getKey(f.value);return n.expanded.value.includes(t)}),u=B(()=>{const t=n.getKey(f.value);return n.selectedKeys.value.includes(t)}),C=B(()=>{if(n.propagateSelect.value&&u.value&&b.value&&Array.isArray(n.modelValue.value))return!X(n.getChildren(f.value)||[]).every(s=>n.modelValue.value.find(l=>n.getKey(l)===n.getKey(s)))});function m(t){if(b.value)if(o.value){const s=T().map(a=>a.ref),l=Q(),y=s.indexOf(l),E=[...s].slice(y).find(a=>Number(a.getAttribute("data-indent"))===f.level+1);E&&E.focus()}else S(t)}function x(t){if(o.value)S(t);else{const s=T().map(a=>a.ref),l=Q(),y=s.indexOf(l),E=[...s].slice(0,y).reverse().find(a=>Number(a.getAttribute("data-indent"))===f.level-1);E&&E.focus()}}async function K(t){w("select",t),!(t!=null&&t.defaultPrevented)&&n.onSelect(f.value)}async function i(t){w("toggle",t),!(t!=null&&t.defaultPrevented)&&n.onToggle(f.value)}async function p(t){if(!t)return;const s={originalEvent:t,value:f.value,isExpanded:o.value,isSelected:u.value};te(we,K,s)}async function S(t){if(!t)return;const s={originalEvent:t,value:f.value,isExpanded:o.value,isSelected:u.value};te(Ae,i,s)}return v({isExpanded:o,isSelected:u,isIndeterminate:C,handleToggle:()=>n.onToggle(f.value),handleSelect:()=>n.onSelect(f.value)}),(t,s)=>(I(),M(c(Ie),{"as-child":"",value:t.value,"allow-shift-key":""},{default:R(()=>[V(c(ne),N(t.$attrs,{role:"treeitem",as:t.as,"as-child":t.asChild,"aria-selected":u.value,"aria-expanded":b.value?o.value:void 0,"aria-level":t.level,"data-indent":t.level,"data-selected":u.value?"":void 0,"data-expanded":o.value?"":void 0,onKeydown:[H(G(p,["self","prevent"]),["enter","space"]),s[0]||(s[0]=H(G(l=>c(n).dir.value==="ltr"?m(l):x(l),["prevent"]),["right"])),s[1]||(s[1]=H(G(l=>c(n).dir.value==="ltr"?x(l):m(l),["prevent"]),["left"]))],onClick:s[2]||(s[2]=G(l=>{p(l),S(l)},["stop"]))}),{default:R(()=>[F(t.$slots,"default",{isExpanded:o.value,isSelected:u.value,isIndeterminate:C.value,handleSelect:()=>c(n).onSelect(t.value),handleToggle:()=>c(n).onToggle(t.value)})]),_:3},16,["as","as-child","aria-selected","aria-expanded","aria-level","data-indent","data-selected","data-expanded","onKeydown"])]),_:3},8,["value"]))}}),qe={slots:{root:"relative isolate",item:"",listWithChildren:"ms-4.5 border-s border-default",itemWithChildren:"ps-1.5 -ms-px",link:"relative group w-full flex items-center text-sm before:absolute before:inset-y-px before:inset-x-0 before:z-[-1] before:rounded-md focus:outline-none focus-visible:outline-none focus-visible:before:ring-inset focus-visible:before:ring-2",linkLeadingIcon:"shrink-0",linkLabel:"truncate",linkTrailing:"ms-auto inline-flex gap-1.5 items-center",linkTrailingIcon:"shrink-0 transform transition-transform duration-200 group-data-expanded:rotate-180"},variants:{color:{primary:{link:"focus-visible:before:ring-primary"},secondary:{link:"focus-visible:before:ring-secondary"},success:{link:"focus-visible:before:ring-success"},info:{link:"focus-visible:before:ring-info"},warning:{link:"focus-visible:before:ring-warning"},error:{link:"focus-visible:before:ring-error"},neutral:{link:"focus-visible:before:ring-inverted"}},size:{xs:{link:"px-2 py-1 text-xs gap-1",linkLeadingIcon:"size-4",linkTrailingIcon:"size-4"},sm:{link:"px-2.5 py-1.5 text-xs gap-1.5",linkLeadingIcon:"size-4",linkTrailingIcon:"size-4"},md:{link:"px-2.5 py-1.5 text-sm gap-1.5",linkLeadingIcon:"size-5",linkTrailingIcon:"size-5"},lg:{link:"px-3 py-2 text-sm gap-2",linkLeadingIcon:"size-5",linkTrailingIcon:"size-5"},xl:{link:"px-3 py-2 text-base gap-2",linkLeadingIcon:"size-6",linkTrailingIcon:"size-6"}},selected:{true:{link:"before:bg-elevated"},false:{link:["hover:not-disabled:text-highlighted hover:not-disabled:before:bg-elevated/50","transition-colors before:transition-colors"]}},disabled:{true:{link:"cursor-not-allowed opacity-75"}}},compoundVariants:[{color:"primary",selected:!0,class:{link:"text-primary"}},{color:"secondary",selected:!0,class:{link:"text-secondary"}},{color:"success",selected:!0,class:{link:"text-success"}},{color:"info",selected:!0,class:{link:"text-info"}},{color:"warning",selected:!0,class:{link:"text-warning"}},{color:"error",selected:!0,class:{link:"text-error"}},{color:"neutral",selected:!0,class:{link:"text-highlighted"}}],defaultVariants:{color:"primary",size:"md"}},ze=["disabled"],nl={__name:"Tree",props:{as:{type:null,required:!1},color:{type:null,required:!1},size:{type:null,required:!1},valueKey:{type:null,required:!1,default:"value"},labelKey:{type:null,required:!1,default:"label"},trailingIcon:{type:String,required:!1},expandedIcon:{type:String,required:!1},collapsedIcon:{type:String,required:!1},items:{type:null,required:!1},modelValue:{type:null,required:!1},defaultValue:{type:null,required:!1},multiple:{type:Boolean,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},expanded:{type:Array,required:!1},defaultExpanded:{type:Array,required:!1},selectionBehavior:{type:String,required:!1},propagateSelect:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1}},emits:["update:expanded","update:modelValue"],setup(r,{emit:v}){const e=r,f=v,w=oe(),n=ue(),T=ge(Te(e,"as","modelValue","defaultValue","items","multiple","expanded","disabled","propagateSelect"),f),[b,o]=ie(),u=B(()=>{var i;return Z({extend:Z(qe),...((i=n.ui)==null?void 0:i.tree)||{}})({color:e.color,size:e.size})});function C(i){return U(i,e.labelKey)}function m(i){return U(i,e.valueKey)??U(i,e.labelKey)}function x(i){var t;const p=i.defaultExpanded?m(i):null,S=((t=i.children)==null?void 0:t.flatMap(s=>x(s)))??[];return[p,...S].filter(Boolean)}const K=B(()=>{var i;return e.defaultExpanded??((i=e.items)==null?void 0:i.flatMap(p=>x(p)))});return(i,p)=>{var S;return I(),D(ee,null,[V(c(b),null,{default:R(({items:t,level:s})=>[(I(!0),D(ee,null,de(t,(l,y)=>{var _,E;return I(),D("li",{key:`${s}-${y}`,class:A(s>0?u.value.itemWithChildren({class:(_=e.ui)==null?void 0:_.itemWithChildren}):u.value.item({class:(E=e.ui)==null?void 0:E.item}))},[V(c(Be),{"as-child":"",level:s,value:l,onToggle:l.onToggle,onSelect:l.onSelect},{default:R(({isExpanded:a,isSelected:d})=>{var g,h,k;return[ce("button",{disabled:l.disabled||r.disabled,class:A(u.value.link({class:(g=e.ui)==null?void 0:g.link,selected:d,disabled:l.disabled||r.disabled}))},[F(i.$slots,l.slot||"item",N({ref_for:!0},{index:y,level:s,expanded:a,selected:d},{item:l}),()=>{var q,z,P;return[F(i.$slots,l.slot?`${l.slot}-leading`:"item-leading",N({ref_for:!0},{index:y,level:s,expanded:a,selected:d},{item:l}),()=>{var $,L,O;return[l.icon?(I(),M(j,{key:0,name:l.icon,class:A(u.value.linkLeadingIcon({class:($=e.ui)==null?void 0:$.linkLeadingIcon}))},null,8,["name","class"])):(L=l.children)!=null&&L.length?(I(),M(j,{key:1,name:a?r.expandedIcon??c(n).ui.icons.folderOpen:r.collapsedIcon??c(n).ui.icons.folder,class:A(u.value.linkLeadingIcon({class:(O=e.ui)==null?void 0:O.linkLeadingIcon}))},null,8,["name","class"])):W("",!0)]}),C(l)||w[l.slot?`${l.slot}-label`:"item-label"]?(I(),D("span",{key:0,class:A(u.value.linkLabel({class:(q=e.ui)==null?void 0:q.linkLabel}))},[F(i.$slots,l.slot?`${l.slot}-label`:"item-label",N({ref_for:!0},{item:l,index:y,level:s,expanded:a,selected:d},{item:l}),()=>[fe(pe(C(l)),1)])],2)):W("",!0),l.trailingIcon||(z=l.children)!=null&&z.length||w[l.slot?`${l.slot}-trailing`:"item-trailing"]?(I(),D("span",{key:1,class:A(u.value.linkTrailing({class:(P=e.ui)==null?void 0:P.linkTrailing}))},[F(i.$slots,l.slot?`${l.slot}-trailing`:"item-trailing",N({ref_for:!0},{item:l,index:y,level:s,expanded:a,selected:d},{item:l}),()=>{var $,L,O;return[l.trailingIcon?(I(),M(j,{key:0,name:l.trailingIcon,class:A(u.value.linkTrailingIcon({class:($=e.ui)==null?void 0:$.linkTrailingIcon}))},null,8,["name","class"])):(L=l.children)!=null&&L.length?(I(),M(j,{key:1,name:r.trailingIcon??c(n).ui.icons.chevronDown,class:A(u.value.linkTrailingIcon({class:(O=e.ui)==null?void 0:O.linkTrailingIcon}))},null,8,["name","class"])):W("",!0)]})],2)):W("",!0)]})],10,ze),(h=l.children)!=null&&h.length&&a?(I(),D("ul",{key:0,class:A(u.value.listWithChildren({class:(k=e.ui)==null?void 0:k.listWithChildren}))},[V(c(o),{items:l.children,level:s+1},null,8,["items","level"])],2)):W("",!0)]}),_:2},1032,["level","value","onToggle","onSelect"])],2)}),128))]),_:3}),V(c(Ee),N(c(T),{class:u.value.root({class:[e.class,(S=e.ui)==null?void 0:S.root]}),"get-key":m,"default-expanded":K.value,"selection-behavior":r.selectionBehavior}),{default:R(()=>[V(c(o),{items:r.items,level:0},null,8,["items"])]),_:1},16,["class","default-expanded","selection-behavior"])],64)}}};export{nl as default};
